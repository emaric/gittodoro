{"version":3,"file":"index.test.js","sourceRoot":"","sources":["index.test.ts"],"names":[],"mappings":"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","sourcesContent":["import app from '@/examples/cli-app/index'\nimport { SessionCLIApp } from './controller'\n\njest.useFakeTimers()\njest.spyOn(global, 'setTimeout')\ndescribe('[index] unit tests', () => {\n  describe('when trying to start a new session for up to one long break interval', () => {\n    const duration = SessionCLIApp.DEFAULT_DURATION\n    const consoleLog = jest.fn()\n    console.log = consoleLog\n\n    app.run()\n\n    it('should display the first state pomodoro and the remaining time', () => {\n      expect(setTimeout).toHaveBeenCalledTimes(1)\n      expect(consoleLog.mock.calls.at(-1).at(-1)).toBe(\n        'pomodoro : ' + duration.pomodoro\n      )\n    })\n\n    it('should display the short state and the remaining time', () => {\n      jest.advanceTimersByTime(duration.pomodoro * 1000)\n      expect(setTimeout).toHaveBeenCalledTimes(2)\n      expect(consoleLog.mock.calls.at(-1).at(-1)).toBe(\n        'short : ' + duration.short\n      )\n    })\n\n    it('should display the long state and the remaining time', () => {\n      const elapsedTime = duration.pomodoro\n      const timeTillLongState =\n        duration.longInterval * duration.pomodoro +\n        (duration.longInterval - 1) * duration.short -\n        elapsedTime\n\n      jest.advanceTimersByTime(timeTillLongState * 1000)\n      expect(setTimeout).toHaveBeenCalledTimes(duration.longInterval * 2)\n      expect(consoleLog.mock.calls.at(-1).at(-1)).toBe(\n        'long : ' + duration.long\n      )\n    })\n\n    it('should display that the session has ended when stop is called', () => {\n      jest.advanceTimersByTime(duration.long * 1000)\n      expect(consoleLog.mock.calls.at(-1).at(-1)).toBe(\n        'pomodoro : ' + duration.pomodoro\n      )\n      app.stop()\n\n      expect(consoleLog.mock.calls.at(-1).at(-1)).toBe('Session has ended.')\n    })\n\n    it('should output the process', () => {\n      const output = consoleLog.mock.calls.join('\\n')\n      const expected = `This sample gittodoro app is running...\nUse case #1: The user can start a session.\nStarting a session...\npomodoro : 25\npomodoro : 24\npomodoro : 23\npomodoro : 22\npomodoro : 21\npomodoro : 20\npomodoro : 19\npomodoro : 18\npomodoro : 17\npomodoro : 16\npomodoro : 15\npomodoro : 14\npomodoro : 13\npomodoro : 12\npomodoro : 11\npomodoro : 10\npomodoro : 9\npomodoro : 8\npomodoro : 7\npomodoro : 6\npomodoro : 5\npomodoro : 4\npomodoro : 3\npomodoro : 2\npomodoro : 1\npomodoro : 0\nshort : 5\nshort : 4\nshort : 3\nshort : 2\nshort : 1\nshort : 0\npomodoro : 25\npomodoro : 24\npomodoro : 23\npomodoro : 22\npomodoro : 21\npomodoro : 20\npomodoro : 19\npomodoro : 18\npomodoro : 17\npomodoro : 16\npomodoro : 15\npomodoro : 14\npomodoro : 13\npomodoro : 12\npomodoro : 11\npomodoro : 10\npomodoro : 9\npomodoro : 8\npomodoro : 7\npomodoro : 6\npomodoro : 5\npomodoro : 4\npomodoro : 3\npomodoro : 2\npomodoro : 1\npomodoro : 0\nshort : 5\nshort : 4\nshort : 3\nshort : 2\nshort : 1\nshort : 0\npomodoro : 25\npomodoro : 24\npomodoro : 23\npomodoro : 22\npomodoro : 21\npomodoro : 20\npomodoro : 19\npomodoro : 18\npomodoro : 17\npomodoro : 16\npomodoro : 15\npomodoro : 14\npomodoro : 13\npomodoro : 12\npomodoro : 11\npomodoro : 10\npomodoro : 9\npomodoro : 8\npomodoro : 7\npomodoro : 6\npomodoro : 5\npomodoro : 4\npomodoro : 3\npomodoro : 2\npomodoro : 1\npomodoro : 0\nshort : 5\nshort : 4\nshort : 3\nshort : 2\nshort : 1\nshort : 0\npomodoro : 25\npomodoro : 24\npomodoro : 23\npomodoro : 22\npomodoro : 21\npomodoro : 20\npomodoro : 19\npomodoro : 18\npomodoro : 17\npomodoro : 16\npomodoro : 15\npomodoro : 14\npomodoro : 13\npomodoro : 12\npomodoro : 11\npomodoro : 10\npomodoro : 9\npomodoro : 8\npomodoro : 7\npomodoro : 6\npomodoro : 5\npomodoro : 4\npomodoro : 3\npomodoro : 2\npomodoro : 1\npomodoro : 0\nlong : 10\nlong : 9\nlong : 8\nlong : 7\nlong : 6\nlong : 5\nlong : 4\nlong : 3\nlong : 2\nlong : 1\nlong : 0\npomodoro : 25\nUse case #2: This user can stop a session.\nStoping a session...\nSession has ended.`\n      expect(output).toBe(expected)\n    })\n  })\n})\n"]}